# 用户使用指南

## 界面概览

```
┌─────────────────────────────────────┐
│  🔬 物理实验报告助手                │
├──────────┬──────────────────────────┤
│  侧边栏  │      主内容区            │
│          │                          │
│ 步骤提示 │  [OCR/分析/LLM] 页面    │
│ (1/3)   │                          │
│ (2/3)   │  页面特定内容            │
│ (3/3)   │                          │
│          │  [下载按钮]              │
│ 页面选择 │                          │
│ (单选)   │                          │
│          │                          │
└──────────┴──────────────────────────┘
```

## 三阶段工作流

### 阶段 1️⃣：OCR 识别（上传图像）

1. 在侧边栏选择"OCR识别"
2. 上传包含数据表的实验图像（jpg/png/bmp）
3. 点击"📋 提取数据表格"
4. 在弹出的表格编辑器中修改数据（可添加/删除行）
5. 点击"✅ 确认并保存表格"

**下一步提示**：在左侧菜单选择"数据分析"

---

### 阶段 2️⃣：数据分析与拟合（执行分析）

1. 在侧边栏选择"数据分析"
2. 当前数据表会显示，可下载为 CSV 格式
3. 选择 X、Y 轴列
4. 选择分析类型：
   - 线性拟合
   - 对数拟合
   - 双对数拟合
   - 傅里叶变换
5. 点击"🔍 执行分析"
6. 结果显示后，会出现：
   - 📋 复制拟合结果（TXT 格式）
   - 🔧 自定义拟合结果
     - 📝 输入 LaTeX：手动编写或修改 LaTeX 代码
     - 📥 导入 CSV：导入新的数据表替换当前数据

**完成提示**：
```
✨ 第二阶段（拟合）完成！您现在可以进入第三阶段生成报告。
```

---

### 阶段 3️⃣：LLM 协作（生成报告）

#### 子阶段 A：Plan（规划）
1. 在侧边栏选择"LLM协作"
2. 系统会自动加载您的数据和分析结果
3. 与 AI 对话，说明：
   - 实验名称和目标
   - 测量方法
   - 关键参数
   - 验证的物理规律
4. AI 会问澄清问题并建议报告结构

#### 子阶段 B：Act（撰写）
1. 点击"✅ 开始撰写"
2. 可在"修改要求"中补充说明（可选）
3. 点击"🚀 生成"
4. AI 生成报告片段（LaTeX 格式）

#### 子阶段 C：查看结果
生成完成后，会显示四个标签页：
- 📝 **报告**：AI 生成的报告片段
- 📋 **表**：数据表的 LaTeX 代码
- 🖼️ **图**：拟合图的 LaTeX 引用代码
- 📥 **下载**：单个文件下载

#### 下载完整报告包
在"完整报告包下载"部分点击"⬇️ 生成并下载完整包"

**包含文件**：
- `report_segment.tex` - AI 生成的报告片段
- `data_table.tex` - 数据表（LaTeX 格式）
- `data_table.csv` - 原始数据（CSV 格式）
- `plot.png` - 拟合图像
- `custom_content.tex` - 您自定义的 LaTeX（如有）
- `README.md` - 使用说明

---

## 快捷操作

### 📋 复制数据或结果
- **数据表**：数据分析页面，点击"📋 复制表格"下载 CSV
- **拟合结果**：执行分析后，点击"📋 复制拟合结果"下载文本
- **分析图像**：结果页面 tab4，直接下载图像

### 🔧 自定义拟合内容
- **修改 LaTeX**：在"自定义拟合结果"→"📝 输入LaTeX"中编辑
- **更换数据**：在"自定义拟合结果"→"📥 导入CSV"中导入新文件

### 📦 打包下载
- 在 LLM 协作结果页，点击"📦 完整报告包下载"
- 自动生成包含所有必要文件的 ZIP 文件
- 直接用于 LaTeX 项目

---

## 常见问题

### Q1: 如何在不同阶段间移动？
**A**: 使用侧边栏的"页面选择"单选框。各阶段都有完成提示，指导您进入下一步。

### Q2: 拟合完成后如何修改参数？
**A**: 
- 修改 LaTeX：在"自定义拟合结果"→"📝 输入LaTeX"部分
- 修改数据：在"自定义拟合结果"→"📥 导入CSV"部分导入新 CSV

### Q3: 能否跳过 Plan 阶段直接开始撰写？
**A**: 可以。点击"✅ 开始撰写"后，系统会使用已有的数据进行 Act 阶段。建议先进行 Plan 沟通以获得更好效果。

### Q4: 下载的 ZIP 文件怎么用？
**A**: 
1. 解压 ZIP 到您的 LaTeX 项目目录
2. 在主文档中使用 `\input{report_segment.tex}` 导入报告
3. 根据需要调整表格和图像的大小

### Q5: 自定义 LaTeX 内容会保存吗？
**A**: 会的。自定义内容保存在 session 中，会包含在最终的下载包中。

---

## 工作流完整示例

```
1. 上传图像 (OCR 页面)
   ↓
2. 提取并保存表格
   ↓
3. 进入数据分析 (侧边栏)
   ↓
4. 选择列并执行拟合
   ↓
5. 查看拟合结果
   ↓
6. [可选] 修改 LaTeX 或导入新数据
   ↓
7. 进入 LLM 协作 (侧边栏)
   ↓
8. Plan 阶段：与 AI 对话确认需求
   ↓
9. Act 阶段：生成报告片段
   ↓
10. 查看结果并下载完整包 (ZIP)
    ↓
11. 在 LaTeX 项目中使用
```

---

## 提示

💡 **最佳实践**：
- 在 OCR 时确保图像清晰，表格结构明显
- 在 Plan 阶段充分沟通，让 AI 了解实验背景
- 若 LaTeX 知识不足，可在"自定义拟合结果"中参考生成的代码
- 定期下载报告包备份，避免数据丢失

🔔 **已知限制**：
- 图像文件大小有限制（建议 < 5MB）
- LaTeX 预览暂不支持，需在本地编译查看
- 一次只能处理一个实验，新实验需点击"🔄 新实验"重置

---

最后更新：2025-12-23
